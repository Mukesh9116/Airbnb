first we init the json file
 
 command -> npm init -y (se json file create ho jati hai)

npm package ko include kiya ---------->>>>>>>

AUR PHIR HAMNE -> npm i express 
AUR PHIR HAMNE -> npm i mongoose
AUR PHIR HAMNE -> npm i ejs

// Model : Listing ------->>

(i) tittle -> string
(ii) description-> string
(iii) image-> string
(iv) price -> Number
(v) location-> string
(vi) country-> string


// What is EJS Mate ? 

It help to create a template or layout.


                   client -> front -> backend
Form Validations -> 
                   server -> db(schema) / error handle.

When we enter data in the form, the browser and/or the webserver weill chek to see that the data is in the correct format and withn the constraints set by the application.


// Validations of Schema ------>>>>>> joi is used for the Schema validation -> ye server side schema hota hai.


// New Model: Reviews ------>>> 

// comment -> string 
// rating (1 to 5)
// createdAt

// Create Reviews ---->>

(1) Setting up the Reviews Form.


// Create Reviews --->
2. Submitting the form ---> reveiw add


POST /listings/:id/reviews


// Validations for Reviews ---->>

(1) Client (form).
(2) Server (joi).


// Render Reviews ===>>>




// Deleting Reviews(delete button) ---->> 
Mongo $pull operator -->

$pull -> The $pull operator removes from an existing array all instances of a value or values that match a specified condition.


// Miscellaneous 

// Topic to cover-->>

// (i) Express Router.
// (ii) Cookies.

(i) Express Router.

Express Routers are a way to organize your Express application such that our primary app.js file does not become bloated.


const router = express.Router() // Create a new Router object.



// Cookies -- Web Cookies -> HTTP cookies are small blocks of data created by a web server while a user is browsing a website and placed on the user's computer or other device by the user's web browser.

// http cookie pe ja ke read kar sakte hai eske bare me.

// How to send the cookies --->> cookies send by the server.

// express ke pas bhi ye ability hoti hai ki usko ham cookies bhej sakte hai.

Note -> agar hamne ek bar cookies send kar diya to vo website ke har path pe dikhai degi.

cookies ko access and pass kaise karenge.

//One Session -> jab bhi hamara client server se ek bar intract karta hai to use one session kahte hai.


What is State?

Stateful Protocol----->>>>

Stateful Protocol require server to save the status and session information .

eg -> ftp (file transfer protocol)

(protocol -> jin bhi rule ko hamare req and res follow karte hai unko ham protocol kahte hai.)

Stateless Protocol ------>>

Stateless Protocol does not require the server to retain the server information or server information.

eg -> http (Hypertext Transfer Protocol)


// Express Sessions -> An attempt to make our session stateful.
 

server side----->>>

user1                                client side--->>
sessionid(101):{
    itemp : laptop                        101
    item: charger
}

user2 
sessionid(102):{
    item : mobile                           102
    item : charger cable
}






connect-flash ===========>>>>>>

The flash is a special area of the session used for storing messages. Messages are written to the flash and cleared after being displayed to the user.

// Using Sessions -> 


Adding Cookie Options--->> cookies ka kam session ko track karna.

// cookies ka expaery data nahi hota hai.

// agar ham kisi website ko login karne ke bad chhod dete hai to kuchh din tak login nahi karna padta ya usko kaise pata ki kaun si email id se pahle login kiya gaya tha. ye hame cookies ke davara pata chalata hai.



// Let's understand ---->> 

// Authentication -> (means jo byakti kah raha hai vo vahi hai). (sign/login)

Authentication is the process of verifying who someone is 

Authorization -> Authorization is the process of verifying what specific applications, files and data a user has access to .


// Storing Passwords -> We NEVER store the passwords as it is. We store their hashed form.

password "Sonu@7575" -> Hashing Function -> How to stored "98kgjajr39853nkdfj5903jfuy8wuht48u90fj" 


signup karte time hona hi chahiye-->> email
                                --->> username
                                --->>password


Hashing Function --> same input string ke liye same value of output dega. jisse hamari password match kar jati hai.


// Hashing -> What we need to know ? ==============>>>>>>>>>

for every input , there is a fixed ouput

They are one - way functions, we can't get input from output 

For a diffrent input, there is a different ouput but of same length

Small changes in input should bring large changes in output.

Hashing Function eg-> SHA256 , MD5,CRC ,BCRYPT



// SALTING ----->> salt = "%?@" jo starting ya last me add kar diya jata hai usi ko salt kahte hai.



Password salting is a technique to protect passwords stored in database by adding a string of 32 or more characters and then hashing them.


// REVERSE LOOKUP TABLE---->>>

hashed form hoti hai. 

hashform 1-> 123456 
hashform 2 -> password
hashform 3=> 1234

// Passport --->> 

npm i passport 

npm i passport-local

npm i passport-local-mongoose

User Model -> 

user:username, password, email

You're free to define your User do you like. Passport-Local Mongoose will add a username,
hash and salt field to store the username, the hashed password and the salt value.


Additionally , Passport-Local Mongoose adds some methds to your Schema. See the API

// Configuring Strategy --->>

passport.initialize() 

A middleware that initializes passport.

passport.session()

passport.session()
A web application needs the ability to identify users as they browser from page to page. This series of requests and responses , each associated with the same user, is known as a session.

passport.use(new LocalStrategy(User.authenticate())) 


// Add Styling --->> req.user -->> undefined(not logged in user).

// agar req.user ki value logged in nahi rahega to uski value undefined rahegi. then usko [signup , login] ki button dikhai degi.

obj(logged in) -> (logged in) -> log out

// agar user logged in hai to usko kevel log out ka button dikhai dega.

Login after SignUp--->

Passport's login method automatically establishes a login session 

We can invoke login to automaically login a use.

post-login Page---->> res.redirect("/listings") ab kya kare.


--->>path ---->> login ----> Path. ------>>


// MVC : Model , View , Controller

implement Design Pattern for listings.


// Router.route 

A way to group together routes with different verbs but same paths.


Image Upload ---->>>

1) create new listing ka form hai ye backend me data ke pas photo send nahi kar sakta hai.

2) mongodb me data bson me store hota hai jiska size kam hota hai . (size limit).


// 1 and 2 problem ko hame solve karna hai 

1) form capable of sending files.

2) (3rd paryt service).(cloud services) file save ho jati hai to ek URL/Link return karegi 

3) save this link in mongo.


// Manipulating Form ---->>

enctype = "multipart/form-data" jab ham html me file send karna chahte hai to eska encoding type change karna hota hia.

Cloud Setup ===============>>>

cloudinary & .env file(to store the envirement variable / credentials).




form(file) -> backend (parse) -> cloud (store) -> URL/Link(file) send it mongodb 



Geocoding --->>

Geocoding is the process of converting addresses(like a street address) into geographic coordinates(like latitude and longitude), which you can use to place markers on a map, or position the map.

Storing Coordinates --->> 

GeoJSON 

The most simple structure in GeoJSON is a point. Below is an example point representing the approximate location of San Francisco. Note that longitude comes first in a GeoJSON coordinate array, not latitude.


{
    "type": "Point"
    "coordinates" :[
        -122.5,
        37.7
    ]
}